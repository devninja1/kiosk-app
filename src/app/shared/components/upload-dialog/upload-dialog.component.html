<h2 mat-dialog-title>{{ data.title || 'Import Data' }}</h2>
<div mat-dialog-content class="dialog-body">
  <p>{{ data.helperText || 'Select an Excel file (.xls, .xlsx) up to 5 MB.' }}</p>

  <div class="type-row">
    <div class="type-pill">{{ requestTypeLabels[requestType] }}</div>
    <button mat-stroked-button color="primary" (click)="download()" [disabled]="isDownloading || isUploading || !isOnline">
      <mat-icon class="excel-icon">table_view</mat-icon>
      <span>Export Excel</span>
    </button>
    @if (!isOnline) {
      <small class="offline-hint">Reconnect to export.</small>
    }
  </div>

  <label class="file-drop" for="upload-input">
    <mat-icon>file_upload</mat-icon>
    <span>Choose file</span>
    @if (selectedFile) {
      <small>{{ selectedFile.name }}</small>
    }
    <input
      id="upload-input"
      type="file"
      (change)="onFileSelected($event)"
      accept=".xls,.xlsx"
      hidden>
  </label>

  @if (errorMessage) {
    <div class="error">{{ errorMessage }}</div>
  }

  @if (!isOnline) {
    <div class="offline">Offline detected. Upload is disabled until you reconnect.</div>
  }
</div>

<div mat-dialog-actions align="end">
  <button mat-button (click)="close()" [disabled]="isUploading">Cancel</button>
  <button mat-flat-button color="primary" (click)="upload()" [disabled]="isUploading || !isOnline">Upload</button>
</div>
